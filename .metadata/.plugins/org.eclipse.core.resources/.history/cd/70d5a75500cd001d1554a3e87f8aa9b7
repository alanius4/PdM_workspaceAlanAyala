/*
 * API_delay.c
 *
 *  Created on: Mar 18, 2023
 *      Author: alan
 */
/* Implementation of non-blocking delay functions */
#include "API_delay.h"

void delayInit( delay_t * delay, tick_t duration );
bool_t delayRead( delay_t * delay );
void delayWrite( delay_t * delay, tick_t duration );

void delayInit( delay_t * delay, tick_t duration ){
	delay->duration = duration;
	//delay->startTime = HAL_GetTick();
	delay->running = false;
}

bool_t delayRead( delay_t * delay ){
	if(delay->running == false){
		delay->startTime = HAL_GetTick();
		delay->running = true;
		return 0;}
	else {
		if((HAL_GetTick()-delay->startTime) >= delay->duration){
			delay->running = false;
			return(1);
		}
		else{
			return 0;
		}}}


void delayWrite(delay_t * delay, tick_t duration) {
	// changes the duration for the delay


	delay->duration = duration;
}


